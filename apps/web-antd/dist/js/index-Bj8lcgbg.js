var k=(B,u,t)=>new Promise((p,c)=>{var r=n=>{try{v(t.next(n))}catch(g){c(g)}},y=n=>{try{v(t.throw(n))}catch(g){c(g)}},v=n=>n.done?p(n.value):Promise.resolve(n.value).then(r,y);v((t=t.apply(B,u)).next())});import{a4 as Y,P as x,T as z,a9 as A,aa as S,ab as _,ac as l,x as o,aB as s,a7 as a,aj as d,av as P,aq as R,ai as f,b1 as E}from"../jse/index-index-Bfp9fVLj.js";import{X as H,bL as O,bM as T,bN as h,bu as L}from"./bootstrap-8TZEei42.js";import{C as w}from"./index-sAHdq1L4.js";import{T as X}from"./index-BfQKXdoT.js";import{S as $}from"./index-B-LRQwvO.js";import"./index-Brf31eMN.js";import{F as G,a as C}from"./index-BJdPPNAb.js";import{_ as J}from"./page.vue_vue_type_script_setup_true_lang-BY0axxjX.js";import{b as M}from"./Password-BTLJaSmc.js";import"./index-d0SnXsRb.js";import"./shallowequal-NoPM3EZB.js";import"./Trigger-DOqqEP9A.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./_arrayIncludes-B8uzE354.js";import"./Overflow-bo4x4DTi.js";import"./index-D27JxLQ4.js";import"./index-B4u-ZZTz.js";import"./colors-BPXzNSR4.js";import"./collapseMotion-B5MEdO-q.js";import"./slide-CIRZRFAB.js";import"./useRefs-qMOa5Z2N.js";import"./hasIn-DZ2VGsD9.js";import"./isMobile-8sZ0LT6r.js";import"./useMergedState-D4hu3SXC.js";import"./isPlainObject-C6CdBuZO.js";import"./responsiveObserve-DvNweebH.js";import"./useFlexGapSupport-D2tEWaK3.js";import"./debounce-XLPEvZnf.js";import"./FormItemContext-rLUZDVS8.js";import"./statusUtils-Du58bhOV.js";import"./BaseInput-BGap_2jZ.js";import"./index-hbqzz9bt.js";import"./EyeOutlined-Dd3Pi4Q1.js";const K={class:"flex items-center space-x-6"},Q={class:"flex-1"},W={class:"text-xl font-semibold text-gray-900"},Z={class:"text-gray-500"},ss={class:"mt-2 flex items-center space-x-4 text-sm text-gray-500"},es={key:0},ts={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},as={key:1,class:"space-y-4"},os={class:"grid grid-cols-3 gap-4 text-sm"},rs={class:"col-span-2"},ls={class:"grid grid-cols-3 gap-4 text-sm"},ds={class:"col-span-2"},is={class:"grid grid-cols-3 gap-4 text-sm"},ns={class:"col-span-2"},ps={class:"grid grid-cols-3 gap-4 text-sm"},ms={class:"col-span-2"},us={class:"grid grid-cols-3 gap-4 text-sm"},cs={class:"col-span-2"},vs={class:"grid grid-cols-3 gap-4 text-sm"},gs={class:"col-span-2"},_s={key:2,class:"text-center text-gray-500"},xs={class:"space-y-4"},fs=Y({__name:"index",setup(B){const u=x(!1),t=x(null),p=x(!1),c=x(),r=z({old_password:"",new_password:"",confirm_password:""}),y={old_password:[{required:!0,message:"请输入当前密码",trigger:"blur"}],new_password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:50,message:"密码长度应为6-50字符",trigger:"blur"}],confirm_password:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(m,e)=>e!==r.new_password?Promise.reject(new Error("两次输入的密码不一致")):Promise.resolve(),trigger:"blur"}]},v=()=>k(null,null,function*(){u.value=!0;try{const m=yield T.getProfile();t.value=m}catch(m){h.error("获取个人信息失败")}finally{u.value=!1}}),n=()=>{b(),p.value=!0},g=()=>k(null,null,function*(){try{yield c.value.validate(),yield T.changePassword({old_password:r.old_password,new_password:r.new_password}),h.success("密码修改成功"),p.value=!1,b()}catch(m){h.error("密码修改失败")}}),U=()=>{p.value=!1,b()},b=()=>{Object.assign(r,{old_password:"",new_password:"",confirm_password:""})},F=m=>E(m).format("YYYY-MM-DD HH:mm:ss");return A(()=>{v()}),(m,e)=>(_(),S(a(J),{description:"查看和管理您的个人信息，修改密码保护账户安全",title:"个人资料"},{default:l(()=>[o(a(w),{class:"mb-6",title:"个人信息"},{default:l(()=>{var i,j,D,N,V,q;return[s("div",K,[e[5]||(e[5]=s("div",{class:"flex-shrink-0"},[s("div",{class:"flex h-20 w-20 items-center justify-center rounded-full bg-blue-100"},[s("svg",{class:"h-10 w-10 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])])],-1)),s("div",Q,[s("h3",W,d(((i=t.value)==null?void 0:i.real_name)||((j=t.value)==null?void 0:j.username)||"未知用户"),1),s("p",Z,d(((D=t.value)==null?void 0:D.email)||"暂无邮箱"),1),s("div",ss,[s("span",null,"用户名: "+d((N=t.value)==null?void 0:N.username),1),(V=t.value)!=null&&V.phone?(_(),P("span",es,"电话: "+d(t.value.phone),1)):R("",!0),s("span",null,[e[4]||(e[4]=f(" 状态: ")),o(a(X),{color:((q=t.value)==null?void 0:q.status)===1?"green":"red",size:"small"},{default:l(()=>{var I;return[f(d(((I=t.value)==null?void 0:I.status)===1?"正常":"禁用"),1)]}),_:1},8,["color"])])])])])]}),_:1}),s("div",ts,[o(a(w),{title:"基本信息"},{default:l(()=>[u.value?(_(),S(a($),{key:0})):t.value?(_(),P("div",as,[s("div",os,[e[6]||(e[6]=s("div",{class:"text-gray-500"},"用户名",-1)),s("div",rs,d(t.value.username),1)]),s("div",ls,[e[7]||(e[7]=s("div",{class:"text-gray-500"},"真实姓名",-1)),s("div",ds,d(t.value.real_name||"暂未设置"),1)]),s("div",is,[e[8]||(e[8]=s("div",{class:"text-gray-500"},"邮箱地址",-1)),s("div",ns,d(t.value.email||"暂未设置"),1)]),s("div",ps,[e[9]||(e[9]=s("div",{class:"text-gray-500"},"电话号码",-1)),s("div",ms,d(t.value.phone||"暂未设置"),1)]),s("div",us,[e[10]||(e[10]=s("div",{class:"text-gray-500"},"最后登录",-1)),s("div",cs,d(t.value.last_login?F(t.value.last_login):"从未登录"),1)]),s("div",vs,[e[11]||(e[11]=s("div",{class:"text-gray-500"},"注册时间",-1)),s("div",gs,d(F(t.value.created_at)),1)])])):(_(),P("div",_s,e[12]||(e[12]=[s("p",null,"加载失败，请刷新重试",-1)])))]),_:1}),o(a(w),{title:"密码管理"},{default:l(()=>[s("div",xs,[e[14]||(e[14]=s("div",{class:"rounded border border-yellow-200 bg-yellow-50 p-4"},[s("p",{class:"text-sm text-yellow-800"},[s("strong",null,"安全提醒："),f(" 定期更改密码有助于保护您的账户安全。建议使用包含字母、数字和特殊字符的强密码。 ")])],-1)),o(a(H),{type:"primary",block:"",onClick:n},{default:l(()=>e[13]||(e[13]=[f(" 修改密码 ")])),_:1})])]),_:1})]),o(a(w),{class:"mt-6",title:"账户统计"},{default:l(()=>e[15]||(e[15]=[s("div",{class:"grid grid-cols-2 gap-4 md:grid-cols-4"},[s("div",{class:"text-center"},[s("div",{class:"text-2xl font-bold text-blue-600"},"--"),s("div",{class:"text-sm text-gray-500"},"创建的短网址")]),s("div",{class:"text-center"},[s("div",{class:"text-2xl font-bold text-green-600"},"--"),s("div",{class:"text-sm text-gray-500"},"总点击数")]),s("div",{class:"text-center"},[s("div",{class:"text-2xl font-bold text-orange-600"},"--"),s("div",{class:"text-sm text-gray-500"},"活跃的AB测试")]),s("div",{class:"text-center"},[s("div",{class:"text-2xl font-bold text-purple-600"},"--"),s("div",{class:"text-sm text-gray-500"},"API调用次数")])],-1),s("div",{class:"mt-4 text-center text-sm text-gray-500"}," 统计功能开发中，敬请期待 ",-1)])),_:1}),o(a(O),{open:p.value,"onUpdate:open":e[3]||(e[3]=i=>p.value=i),title:"修改密码",width:"400px",onOk:g,onCancel:U},{default:l(()=>[o(a(G),{ref_key:"passwordFormRef",ref:c,model:r,rules:y,layout:"vertical"},{default:l(()=>[o(a(C),{label:"当前密码",name:"old_password"},{default:l(()=>[o(a(M),{value:r.old_password,"onUpdate:value":e[0]||(e[0]=i=>r.old_password=i),placeholder:"请输入当前密码"},null,8,["value"])]),_:1}),o(a(C),{label:"新密码",name:"new_password"},{default:l(()=>[o(a(M),{value:r.new_password,"onUpdate:value":e[1]||(e[1]=i=>r.new_password=i),placeholder:"请输入新密码"},null,8,["value"])]),_:1}),o(a(C),{label:"确认新密码",name:"confirm_password"},{default:l(()=>[o(a(M),{value:r.confirm_password,"onUpdate:value":e[2]||(e[2]=i=>r.confirm_password=i),placeholder:"请确认新密码"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])]),_:1}))}}),Zs=L(fs,[["__scopeId","data-v-b5ac2e96"]]);export{Zs as default};
