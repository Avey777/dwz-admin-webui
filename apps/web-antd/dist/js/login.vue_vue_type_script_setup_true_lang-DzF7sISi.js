var y=(p,u,n)=>new Promise((d,i)=>{var m=a=>{try{c(n.next(a))}catch(l){i(l)}},r=a=>{try{c(n.throw(a))}catch(l){i(l)}},c=a=>a.done?d(a.value):Promise.resolve(a.value).then(m,r);c((n=n.apply(p,u)).next())});import{b1 as $,b0 as t,bv as C,b2 as F,bt as N,ap as A,bw as q}from"./bootstrap-8TZEei42.js";import{T as I}from"./auth-title-B5nDJ2YI.js";import{a4 as E,T as K,J as R,P as U,a9 as j,av as _,ab as f,a8 as B,x as M,aq as P,ac as g,ai as w,aj as h,a7 as o,aB as S,aa as L,aV as D}from"../jse/index-index-Bfp9fVLj.js";import{u as z,s as T}from"./use-vben-form-BApI2rsN.js";const G=["onKeydown"],J={class:"text-muted-foreground"},Q={key:0,class:"mb-6 flex justify-between"},Y={class:"flex-center"},x=E({name:"AuthenticationLogin",__name:"login",props:{formSchema:{default:()=>[]},codeLoginPath:{default:"/auth/code-login"},forgetPasswordPath:{default:"/auth/forget-password"},loading:{type:Boolean,default:!1},qrCodeLoginPath:{default:"/auth/qrcode-login"},registerPath:{default:"/auth/register"},showCodeLogin:{type:Boolean,default:!0},showForgetPassword:{type:Boolean,default:!0},showQrcodeLogin:{type:Boolean,default:!0},showRegister:{type:Boolean,default:!0},showRememberMe:{type:Boolean,default:!0},showThirdPartyLogin:{type:Boolean,default:!0},subTitle:{default:""},title:{default:""},submitButtonText:{default:""}},emits:["submit"],setup(p,{expose:u,emit:n}){const d=p,i=n,[m,r]=z(K({commonConfig:{hideLabel:!0,hideRequiredMark:!0},schema:R(()=>d.formSchema),showDefaultActions:!1})),c=$(),a=`REMEMBER_ME_USERNAME_${location.hostname}`,l=localStorage.getItem(a)||"",b=U(!!l);function k(){return y(this,null,function*(){const{valid:e}=yield r.validate(),s=yield r.getValues();e&&(localStorage.setItem(a,b.value?s==null?void 0:s.username:""),i("submit",s))})}function V(e){c.push(e)}return j(()=>{l&&r.setFieldValue("username",l)}),u({getFormApi:()=>r}),(e,s)=>(f(),_("div",{onKeydown:N(A(k,["prevent"]),["enter"])},[B(e.$slots,"title",{},()=>[M(I,null,{desc:g(()=>[S("span",J,[B(e.$slots,"subTitle",{},()=>[w(h(e.subTitle||o(t)("authentication.loginSubtitle")),1)])])]),default:g(()=>[B(e.$slots,"title",{},()=>[w(h(e.title||`${o(t)("authentication.welcomeBack")} 👋🏻`),1)])]),_:3})]),M(o(m)),e.showRememberMe||e.showForgetPassword?(f(),_("div",Q,[S("div",Y,[e.showRememberMe?(f(),L(o(C),{key:0,checked:b.value,"onUpdate:checked":s[0]||(s[0]=v=>b.value=v),name:"rememberMe"},{default:g(()=>[w(h(o(t)("authentication.rememberMe")),1)]),_:1},8,["checked"])):P("",!0)]),e.showForgetPassword?(f(),_("span",{key:0,class:"vben-link text-sm font-normal",onClick:s[1]||(s[1]=v=>V(e.forgetPasswordPath))},h(o(t)("authentication.forgetPassword")),1)):P("",!0)])):P("",!0),M(o(F),{class:D([{"cursor-wait":e.loading},"w-full"]),loading:e.loading,"aria-label":"login",onClick:k},{default:g(()=>[w(h(e.submitButtonText||o(t)("common.login")),1)]),_:1},8,["class","loading"])],40,G))}}),ee=E({name:"Login",__name:"login",setup(p){const u=q(),n=R(()=>[{component:"VbenInput",componentProps:{placeholder:t("authentication.usernameTip")},fieldName:"username",label:t("authentication.username"),rules:T().min(1,{message:t("authentication.usernameTip")})},{component:"VbenInputPassword",componentProps:{placeholder:t("authentication.password")},fieldName:"password",label:t("authentication.password"),rules:T().min(1,{message:t("authentication.passwordTip")})}]),d=i=>y(null,null,function*(){const{username:m,password:r}=i;yield u.authLogin({username:m,password:r})});return(i,m)=>(f(),L(o(x),{"form-schema":n.value,loading:o(u).loginLoading,onSubmit:d},null,8,["form-schema","loading"]))}});export{ee as _};
